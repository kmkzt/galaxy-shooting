import{u as r,d as p,b as E,j as M,R as i,k as u,M as A,l as R,m as k,n as w}from"./index-BKV0M9LI.js";import{u as C,i as f,j as O,k as S}from"./index-B-I7Xy0d.js";import{I as _,u as x}from"./useGameFrame-CA_JlS-l.js";import{t as y}from"./touchObject-XhCMdEdk.js";const z=new S(.3,.3,10),b=new O({color:new f("lightgreen")}),v=({guid:a,position:e,rotation:l,scale:c})=>{const{camera:m}=C(),{position:s,flightSpeed:n}=r(t=>t.spaceShip),h=r(t=>t.meteos),o=p();return x(()=>{if(s.z-m.far>e.z){o(u(a));return}const t=Object.values(h).find(L=>y(L,{position:e,scale:{x:1,y:1,z:10+n}}));if(t){o(A({...t,color:new f("red")})),setTimeout(()=>{o(R(Math.floor(t.scale.x*100))),o(k(t.guid))},100),o(u(a));return}const d={...e,z:e.z-n-5};o(w({guid:a,position:d}))}),i.createElement("mesh",{position:[e.x,e.y,e.z],geometry:z,material:b})},g=()=>{const{position:a}=r(s=>s.spaceShip),e=r(_),l=p(),c=E.useCallback(()=>{l(M({position:a,scale:{x:.3,y:.3,z:10}}))},[l,a]);E.useLayoutEffect(()=>{if(e)return window.addEventListener("click",c),()=>{window.removeEventListener("click",c)}},[c,e]);const m=r(s=>s.lasers);return i.createElement(i.Fragment,null,Object.values(m).map(({guid:s,...n})=>i.createElement(v,{key:s,guid:s,...n})))};export{g as default};
