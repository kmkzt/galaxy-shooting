name: Cleanup PR Preview

on:
  pull_request:
    types: [closed]
    branches: [main]

permissions:
  contents: write

concurrency:
  group: preview-${{ github.event.pull_request.number }}

jobs:
  cleanup:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v6

      - name: Remove PR preview
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: >
          .github/scripts/deploy-to-pages.sh cleanup
          "pr/${{ github.event.pull_request.number }}"
          --message "cleanup: remove PR #${{ github.event.pull_request.number }} preview"
