import{u as n,b as m,j as i}from"./index-CMnVFo_k.js";import{u as j,C as u,n as v,o as w}from"./Scene-CZrXUGXj.js";import{u as z}from"./useGameFrame-DPUcyCxG.js";import{t as y}from"./collision-XhCMdEdk.js";const S=new w(.3,.3,10),b=new v({color:new u("lightgreen")}),g=({guid:a,position:e,rotation:o,scale:t})=>{const r=j(s=>s.camera);return z(()=>{const{spaceShip:s,meteos:p,removeLaser:l,replaceLaser:f,replaceMeteo:d,removeMeteo:x,incPoint:h}=n.getState();if(s.position.z-r.far>e.z){l(a);return}const c=Object.values(p).find(L=>y(L,{position:e,scale:{x:1,y:1,z:10+s.flightSpeed}}));if(c){d({...c,color:new u("red")}),setTimeout(()=>{h(Math.floor(c.scale.x*100)),x(c.guid)},100),l(a);return}f({guid:a,position:{...e,z:e.z-s.flightSpeed-5}})}),i.jsx("mesh",{position:[e.x,e.y,e.z],geometry:S,material:b})},G=()=>{const a=n(t=>t.lasers),e=n(t=>t.addLaser),o=m.useCallback(()=>{const{spaceShip:t,isGameActive:r}=n.getState();r()&&e({position:t.position,rotation:{x:0,y:0,z:0},scale:{x:.3,y:.3,z:10}})},[e]);return m.useLayoutEffect(()=>(window.addEventListener("click",o),()=>{window.removeEventListener("click",o)}),[o]),i.jsx(i.Fragment,{children:Object.values(a).map(({guid:t,...r})=>i.jsx(g,{guid:t,...r},t))})};export{G as default};
